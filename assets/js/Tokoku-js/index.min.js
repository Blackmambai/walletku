document.addEventListener("DOMContentLoaded",(()=>{document.getElementById("fileImport");const e=document.getElementById("aktifitasTerakhir");document.getElementById("kunjunganHariIni");let t=null;!function(){const n=JSON.parse(localStorage.getItem("nota")||"[]"),a=JSON.parse(localStorage.getItem("produk")||"[]");(new Date).toISOString().split("T")[0];const l=n.reduce(((e,t)=>e+t.totalHarga),0);document.getElementById("totalPenjualan").textContent=`Rp ${l.toLocaleString()}`;const o=a.reduce(((e,t)=>e+t.stokProduk),0);document.getElementById("totalStokProduk").textContent=o;const s=n.sort(((e,t)=>new Date(t.tanggal)-new Date(e.tanggal))).slice(0,5).map((e=>`\n                <li class="list-group-item d-flex justify-content-between align-items-start">\n                    <div class="ms-2 me-auto">\n                        <div class="fw-bold">${e.namaPelanggan||"Pelanggan Umum"}</div>\n                        ${e.tanggal}\n                    </div>\n                    <span class="badge bg-primary rounded-pill">\n                        Rp ${e.totalHarga.toLocaleString()}\n                    </span>\n                </li>\n            `)).join("");e.innerHTML=s;const r=n.flatMap((e=>e.produk)).reduce(((e,t)=>(e[t.nama]=(e[t.nama]||0)+t.jumlah,e)),{}),i=Object.entries(r).sort(((e,t)=>t[1]-e[1])).slice(0,20).map((([e,t])=>`\n                <li class="list-group-item d-flex justify-content-between align-items-center">\n                    ${e}\n                    <span class="badge bg-primary rounded-pill">${t}</span>\n                </li>\n            `)).join("");document.getElementById("produkTerlaris").innerHTML=i,t&&t.destroy(),function(e){const n=document.getElementById("grafikPenjualan").getContext("2d"),a=e.reduce(((e,t)=>{const n=t.tanggal.split(" ")[0];return e[n]=(e[n]||0)+t.totalHarga,e}),{}),l=Object.keys(a).sort(((e,t)=>new Date(t)-new Date(e))).slice(0,7).reverse(),o=l.map((e=>a[e]||0));t=new Chart(n,{type:"bar",data:{labels:l,datasets:[{label:"Penjualan",data:o,backgroundColor:"rgba(75, 192, 192, 0.6)",borderWidth:0,borderRadius:4,barThickness:20}]},options:{responsive:!0,scales:{y:{beginAtZero:!0,ticks:{callback:e=>"Rp "+e.toLocaleString(),color:"#6c757d"},grid:{display:!1},border:{display:!1}},x:{display:!1}},plugins:{legend:{display:!1}}}})}(n)}()}));